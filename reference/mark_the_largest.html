<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Mark units that have a large x — mark_the_largest • struktuR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Mark units that have a large x — mark_the_largest"><meta name="description" content="A function that marks the units that have the largest x-value in a data set.
Can mark the largest ones so that they cover a specified percentage of total x (method 1), can mark
values that are greater than a specified threshold (method 2), can mark the n largest values (method 3)
and can mark the largest so a specified percent of all units are marked (method 4)."><meta property="og:description" content="A function that marks the units that have the largest x-value in a data set.
Can mark the largest ones so that they cover a specified percentage of total x (method 1), can mark
values that are greater than a specified threshold (method 2), can mark the n largest values (method 3)
and can mark the largest so a specified percent of all units are marked (method 4)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">struktuR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/FillStrata.html">FillStrata</a></li>
    <li><a class="dropdown-item" href="../articles/merge_lonely_strata.html">Merge lonely strata</a></li>
    <li><a class="dropdown-item" href="../articles/struktur-vignette.html">Estimation using struktuR</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Mark units that have a large x</h1>

      <div class="d-none name"><code>mark_the_largest.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A function that marks the units that have the largest x-value in a data set.
Can mark the largest ones so that they cover a specified percentage of total x (method 1), can mark
values that are greater than a specified threshold (method 2), can mark the n largest values (method 3)
and can mark the largest so a specified percent of all units are marked (method 4).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mark_the_largest</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">idVar</span>,</span>
<span>  strataVar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">xVar</span>,</span>
<span>  yVar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  par_method1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  par_method2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  par_method3 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  par_method4 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_n_method1and2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_x_method3and4 <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Input data set of class data.frame</p></dd>


<dt id="arg-idvar">idVar<a class="anchor" aria-label="anchor" href="#arg-idvar"></a></dt>
<dd><p>Name of identification variable. Should not have NA's, and should not have duplicates</p></dd>


<dt id="arg-stratavar">strataVar<a class="anchor" aria-label="anchor" href="#arg-stratavar"></a></dt>
<dd><p>Optional. Name of stratification variable. Should not have NA's. If strataVar is given,
the marking is performed within each stratum</p></dd>


<dt id="arg-xvar">xVar<a class="anchor" aria-label="anchor" href="#arg-xvar"></a></dt>
<dd><p>Name of x-variable. Should be numeric. +/-Inf is not allowed. NA's are allowed (would never
be marked)</p></dd>


<dt id="arg-yvar">yVar<a class="anchor" aria-label="anchor" href="#arg-yvar"></a></dt>
<dd><p>Optional. Name of an extra sorting variable. Should be numeric. Only relevant for the
sorting of equal x-values, in which case the x's are ranked according to decreasing y-value.
NA's and +/-Inf are allowed. (NA is rated as less than -Inf)</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>The methods to be used (default is 1). Can choose between method 1, 2, 3 and 4 (see ‘Details’),
and can use multiple methods simultaneously. The methods are specified using a vector</p></dd>


<dt id="arg-par-method-">par_method1<a class="anchor" aria-label="anchor" href="#arg-par-method-"></a></dt>
<dd><p>Percentage for method 1 (default 25). Numeric value within the range [0, 100] (a single
number or a vector with a length equal to the number of strata). If 0, no values are
marked. If 100, all x &gt; 0 are marked (assuming max_n_method1and2 is not used)</p></dd>


<dt id="arg-par-method-">par_method2<a class="anchor" aria-label="anchor" href="#arg-par-method-"></a></dt>
<dd><p>Threshold value for method 2. Numeric value &gt;= 0 (a single number or a vector with a
length equal to the number of strata). If 0, all x &gt; 0 are marked (assuming
max_n_method1and2 is not used)</p></dd>


<dt id="arg-par-method-">par_method3<a class="anchor" aria-label="anchor" href="#arg-par-method-"></a></dt>
<dd><p>Number for method 3 (default 5). Integer 0, 1, 2, ... (a single number or a vector with a
length equal to the number of strata). If 0, no values are marked</p></dd>


<dt id="arg-par-method-">par_method4<a class="anchor" aria-label="anchor" href="#arg-par-method-"></a></dt>
<dd><p>Percentage for method 4 (default 5). Numeric value within the range [0, 100] (a single
number or a vector with a length equal to the number of strata). If 0, no values are
marked. If 100, all x != NA are marked (assuming min_x_method3and4 is not used)</p></dd>


<dt id="arg-max-n-method-and-">max_n_method1and2<a class="anchor" aria-label="anchor" href="#arg-max-n-method-and-"></a></dt>
<dd><p>Optional. Applies to method 1 and 2. Maximum number of markings that can be made.
Integer 0, 1, 2, ...(a single number or a vector with a length equal to the
number of strata)</p></dd>


<dt id="arg-min-x-method-and-">min_x_method3and4<a class="anchor" aria-label="anchor" href="#arg-min-x-method-and-"></a></dt>
<dd><p>Optional. Applies to method 3 and 4. Minimum threshold for x (only x &gt; min_x_method3and4
can be marked). Numeric (a single number or a vector with a length equal to the
number of strata)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The output is a data frame. For each method used, a binary variable is created that shows which units are
marked (the variables are named large1, large2, large3, and large4 for methods 1, 2, 3 and 4 respectively).
Additionally, there is a variable that shows which units are marked for at least one method (the variable is named large).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If strataVar is given, the marking is performed within each stratum. Parameters given as a single number then apply to
each stratum. If a parameter is given as a vector, the length should equal to the number of strata, and the order of
the elements should correspond to the order obtained when the input data is sorted by strataVar using order():
data[order(data[ , strataVar]) , ] <br><br>
Method 1: Marks the largest x-values so that they (at least) cover a specified percentage of the total x-value (x &lt; 0 are not included in the total x-value).
          Only x &gt; 0 can be marked with this method.
          If strataVar is used, this is done per stratum, and the total x-value applies to the stratum.
          If max_n_method1and2 is used, it is not guaranteed that the specified percentage will be achieved. <br><br>
Method 2: Marks x-values that are greater than a specified threshold (x &gt; threshold).
          Only x &gt; 0 can be marked with this method.
          If max_n_method1and2 is used, it's not guaranteed that all x &gt; threshold will be marked. <br><br>
Method 3: Marks the n largest x-values.
          x = NA will never be marked with this method.
          If strataVar is used, it's the n largest per stratum that are marked.
          If min_x_method3and4 is used, it's not guaranteed that the specified number will be marked. <br><br>
Method 4: Marks the largest x-values so that p percent of all units are marked (units with x = NA are not counted in the percentage calculation).
          x = NA will never be marked with this method.
          If strataVar is used, the p percent largest units per stratum are marked.
          If min_x_method3and4 is used, it's not guaranteed that the specified percentage will be achieved. <br><br>
To ensure the same result regardless of the sorting of the input data set, the function sorts the input data set
first by idVar before further sorting and marking is done.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Test dataset</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">956</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">testData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">30</span>, mean <span class="op">=</span> <span class="fl">1000</span>, sd <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       strata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'A'</span>, <span class="fl">12</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'B'</span>, <span class="fl">18</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">testData</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example with method 1, 2 and 3</span></span></span>
<span class="r-in"><span><span class="fu">mark_the_largest</span><span class="op">(</span>data <span class="op">=</span> <span class="va">testData</span>, idVar <span class="op">=</span> <span class="st">'id'</span>, xVar <span class="op">=</span> <span class="st">'x'</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                 par_method1 <span class="op">=</span> <span class="fl">15</span>, par_method2 <span class="op">=</span> <span class="fl">5000</span>, par_method3 <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    id          x par_method1 par_method2 par_method3 large1 large2 large3 large</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  28 1755.82152          15        5000           5      1      0      1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   3 1719.23612          15        5000           5      1      0      1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   1 1688.47966          15        5000           5      1      0      1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  24 1553.10406          15        5000           5      0      0      1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  17 1395.47290          15        5000           5      0      0      1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   4 1348.71579          15        5000           5      0      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  30 1268.94547          15        5000           5      0      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   5 1266.01136          15        5000           5      0      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  14 1174.49728          15        5000           5      0      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 13 1150.16903          15        5000           5      0      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 23 1137.08342          15        5000           5      0      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 12 1081.14497          15        5000           5      0      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 22 1038.01792          15        5000           5      0      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  2  984.35659          15        5000           5      0      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 16  959.67966          15        5000           5      0      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 29  914.75150          15        5000           5      0      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 19  788.83780          15        5000           5      0      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 11  700.85778          15        5000           5      0      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 25  610.86377          15        5000           5      0      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 10  601.84912          15        5000           5      0      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 20  534.26997          15        5000           5      0      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  8  476.92625          15        5000           5      0      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  9  451.53607          15        5000           5      0      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  7  422.98241          15        5000           5      0      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  6  305.84389          15        5000           5      0      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 18  113.40098          15        5000           5      0      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 21  -44.53893          15        5000           5      0      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 26  -80.36282          15        5000           5      0      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 15         NA          15        5000           5      0      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 27         NA          15        5000           5      0      0      0     0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example with stratification</span></span></span>
<span class="r-in"><span><span class="fu">mark_the_largest</span><span class="op">(</span>data <span class="op">=</span> <span class="va">testData</span>, idVar <span class="op">=</span> <span class="st">'id'</span>, strataVar <span class="op">=</span> <span class="st">'strata'</span>, xVar <span class="op">=</span> <span class="st">'x'</span>, </span></span>
<span class="r-in"><span>                 method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, par_method1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">30</span><span class="op">)</span>, par_method4 <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    id          x strata par_method1 par_method4 large1 large4 large</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   3 1719.23612      A          20          25      1      1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1 1688.47966      A          20          25      1      1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   4 1348.71579      A          20          25      0      1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   5 1266.01136      A          20          25      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  12 1081.14497      A          20          25      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   2  984.35659      A          20          25      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  11  700.85778      A          20          25      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  10  601.84912      A          20          25      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   8  476.92625      A          20          25      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  9  451.53607      A          20          25      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  7  422.98241      A          20          25      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  6  305.84389      A          20          25      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 28 1755.82152      B          30          25      1      1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 24 1553.10406      B          30          25      1      1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 17 1395.47290      B          30          25      1      1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 30 1268.94547      B          30          25      0      1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 14 1174.49728      B          30          25      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 13 1150.16903      B          30          25      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 23 1137.08342      B          30          25      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 22 1038.01792      B          30          25      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 16  959.67966      B          30          25      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 29  914.75150      B          30          25      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 19  788.83780      B          30          25      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 25  610.86377      B          30          25      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 20  534.26997      B          30          25      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 18  113.40098      B          30          25      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 21  -44.53893      B          30          25      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 26  -80.36282      B          30          25      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 15         NA      B          30          25      0      0     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 27         NA      B          30          25      0      0     0</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Susie Jentoft, Øyvind Langsrud, Anna-Karin Mevik, Melike Oguz Alper.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

